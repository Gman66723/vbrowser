(window["webpackJsonpturt.us"]=window["webpackJsonpturt.us"]||[]).push([[0],{106:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t.n(r),a=t(54),c=t.n(a),i=(t(72),t(3)),u=t(55),s=t(63),l=t(18),d=t(4),f=t(57),p=t(25),h=t(7);p.b.add(h.c,h.k,h.l,h.d,h.e,h.i,h.j,h.g,h.a,h.b,h.f,h.h);var v=f.a,b=t(5),m=t.n(b),g=t(13),y=t(26),w=t(35),O=t(58),E=t(16),k=t(17),j=t(65),x=t(59),S=t(66),R=t(60),D=t.n(R),M=t(61),P=t.n(M),U=new(function(){function e(){Object(E.a)(this,e),this.baseUrl="https://localhost"}return Object(k.a)(e,[{key:"fetch",value:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}(function(){var e=Object(g.a)(m.a.mark((function e(n){var t,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={credentials:"include",headers:{"Content-Type":"application/json"}},e.next=3,fetch(this.baseUrl+n,t);case 3:if(r=e.sent,o=r.json(),r.ok){e.next=7;break}throw new Error(o);case 7:return e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}())},{key:"ping",value:function(){return this.fetch("/")}}]),e}());function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(t,!0).forEach((function(n){Object(O.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var q={REQUEST:"stream/request",READY:"stream/ready"},_={PROVIDE:"identity/provide",REQUEST:"identity/request",RESPONSE:"identity/response"},B=function(e){function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(E.a)(this,n),e=Object(j.a)(this,Object(x.a)(n).call(this));var r=t.server;return e.id=null,e.clientType="client",e.signalServer=r,e.connection=null,e.peers=new Map,e.init(),e}return Object(S.a)(n,e),Object(k.a)(n,[{key:"createPacket",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return JSON.stringify(C({type:e,sender:this.id},n))}},{key:"createPeer",value:function(e){var n=this,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new D.a({initiator:t});return r.cid=e.cid,this.peers.set(r.cid,r),r.on("connect",(function(){r.send(n.createPacket(_.REQUEST))})),r.on("error",(function(e){console.error(e),n.emit("peer.error",e)})),r.on("close",(function(){console.log("Peer Disconnected",r.cid),n.emit("peer.disconnect",r.cid),n.peers.delete(r.cid)})),r.on("data",(function(e){var t=JSON.parse(e),o=t.type,a=Object(w.a)(t,["type"]);console.log(o,a),n[o]&&n[o](a,r)})),r.on("signal",(function(e){n.connection.send(JSON.stringify({type:"signal",target:r.cid,signal:e}))})),r.on("stream",(function(e){console.log(e,r),n.emit("browser.stream",e,r)})),this}},{key:"setIdentity",value:function(e){var n=e.id;this.id=n}},{key:"attachIdentity",value:function(e){console.log("Attach Identity",e)}},{key:"processSignal",value:function(e){this.peers.has(e.cid)||this.createPeer(e,!1),this.peers.get(e.cid).signal(e.signal)}},{key:"_message",value:function(e){var n=JSON.parse(e.data),t=n.type,r=Object(w.a)(n,["type"]);switch(t){case _.PROVIDE:this.setIdentity(r);break;case _.RESPONSE:this.attachIdentity(r);break;case"announce":this.createPeer(r,!0);break;case"signal":this.processSignal(r)}}},{key:q.READY,value:function(e,n){n.send(this.createPacket(q.REQUEST))}},{key:"init",value:function(){var e=Object(g.a)(m.a.mark((function e(){var n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.ping();case 2:this.connection=new WebSocket(this.signalServer),new Array("open","message","error").forEach((function(e){n["_".concat(e)]&&n.connection.addEventListener(e,n["_".concat(e)].bind(n))}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){return this}}]),n}(P.a),T=t(31),L=t(62),I=t.n(L);function J(){var e=Object(i.a)(["\n  flex : 1;\n  position : relative;\n  padding : 20px 20px 0 20px;\n  & video {\n    width : 100%;\n    // background : black;\n  }\n  .waiting-component {\n    position : absolute;\n    top : 0;\n    bottom : 0;\n    left : 0;\n    right : 0;\n  }\n  & .click-shield {\n    position : absolute;\n    outline : none;\n    top : 0;\n    left : 0;\n    right : 0;\n    bottom : 3px;\n    box-sizing : content-box;\n    transition : 500ms all ease-in-out;\n    box-shadow: 0 0 0 transparent;\n    ","\n  }\n"]);return J=function(){return e},e}var W=d.a.div(J(),(function(e){return e.focused?"\n        box-shadow: 0 0 30px rgba(255,255,255,0.2);\n      ":""})),A=function(e){var n=e.source,t=e.children,a=e.vbController,c=e.fullscreen,i=void 0!==c&&c,u=e.aspectRatio,s=void 0===u?"16/9":u,l=Object(r.useRef)(),d=Object(r.useRef)(),f=Object(r.useState)(),p=Object(y.a)(f,2),h=p[0],v=p[1];Object(r.useEffect)((function(){var e=l.current;"srcObject"in e?e.srcObject=n:e.src=window.URL.createObjectURL(n)}),[n,l]),Object(r.useEffect)((function(){if(!h)return d.current&&d.current.blur();d.current&&d.current.focus();var e=function(){return!1};return window.addEventListener("wheel",e),function(){return window.removeEventListener("wheel",e)}}),[h]);var b=function(e){var n=l.current.getBoundingClientRect(),t=1280/n.width,r=720/n.height,o=Math.round(t*(e.clientX-n.left)),a=Math.round(r*(e.clientY-n.top));return console.log(o,a),[o,a]},m=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!!a&&((n<4||n>7)&&e.preventDefault(),a.mouseDown.apply(a,Object(T.a)(b(e)).concat([n])),!1)};return o.a.createElement(W,{className:"container",focused:h,fullscreen:i},o.a.createElement(I.a,{ratio:s,style:{maxWidth:"1280px",margin:"auto",position:"relative"}},o.a.createElement(o.a.Fragment,null,o.a.createElement("video",{ref:l,autoPlay:!0}),o.a.createElement("div",{tabIndex:"0",hidden:!n,className:"click-shield",ref:d,onMouseEnter:function(){return v(!0)},onMouseLeave:function(){return v(!1)},onWheel:function(e){return function(e){var n,t=Math.sign(e.deltaY),r=Math.sign(e.deltaX);if(r||t)return t<0&&(n=4),t>0&&(n=5),r<0&&(n=6),r>0&&(n=7),m(e,n)}(e)},onKeyDown:function(e){console.log(e.key),a.keyDown(e.key),e.preventDefault()},onKeyUp:function(e){a.keyUp(e.key),e.preventDefault()},onContextMenu:function(e){return m(e,3)},onMouseDown:function(e){return m(e,1)},onMouseUp:function(e){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a&&a.mouseUp.apply(a,Object(T.a)(b(e)).concat([n]))}(e,1)},onMouseMove:function(e){a&&a.mouseMove.apply(a,Object(T.a)(b(e)))}}))),!n&&o.a.createElement("div",{className:"waiting-component"},t))},Y={MOUSE_MOVE:1,MOUSE_BTN_DWN:2,MOUSE_BTN_UP:3,MOUSE_BTN_CLK:5,KEY_DOWN:6,KEY_UP:7,REQUEST_CONTROL:8,RELEASE_CONTROL:9,ERROR:255},F=new Set;for(var z in Y)F.add(Y[z]);Y.list=F;var K="https://localhost",Q="/virtual_browser/start",V=function(){function e(n){Object(E.a)(this,e),this.vbClient=n}return Object(k.a)(e,[{key:"mouseUp",value:function(e,n,t){this.vbClient.send(JSON.stringify({type:"mouseUp",args:[e,n,t]}))}},{key:"mouseDown",value:function(e,n,t){console.log("MouseDown",e,n,t),this.vbClient.send(JSON.stringify({type:"mouseDown",args:[e,n,t]}))}},{key:"mouseMove",value:function(e,n){this.vbClient.send(JSON.stringify({type:"mouseMove",args:[e,n]}))}},{key:"keyDown",value:function(e){this.vbClient.send(JSON.stringify({type:"keyDown",args:[e]}))}},{key:"keyUp",value:function(e){this.vbClient.send(JSON.stringify({type:"keyUp",args:[e]}))}}],[{key:"createInstance",value:function(){var e=Object(g.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(K+Q);case 2:return n=e.sent,console.log(n.status),e.abrupt("return",n.status>199&&n.status<300);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();function X(){var e=Object(i.a)(["\n  display : flex;\n  width : 100%;\n  height : 100%;\n  justify-content : center;\n  align-items : center;\n  > content {\n    width : 45%;\n    min-height : 300px;\n    background : rgba(255,255,255,0.3);\n    border-radius : 15px;\n    display : flex;\n    flex-direction : column;\n    padding ; 5px;\n  } \n  button {\n    padding : 10px 5px;\n    background : white;\n    border : 1px solid black;\n    outline : none;\n  }\n"]);return X=function(){return e},e}var G=d.a.div(X());function H(e){var n=e.onRequestBrowser;return o.a.createElement(G,null,o.a.createElement("content",null,o.a.createElement("div",null,"Where do you want to go?",o.a.createElement("input",{type:"text"})),o.a.createElement("div",null,o.a.createElement("button",{onClick:n},"Get Me A Browser"))))}function $(){var e=Object(i.a)(["\n  flex : 1;\n  height : 100%;\n  display : flex;\n  flex-direction : column;\n"]);return $=function(){return e},e}function Z(){var e=Object(i.a)(["\n  flex : 0;\n  flex-basis : 100px;\n  color : white;\n  display : flex;\n  & button {\n    cursor : pointer;\n    background : transparent;\n    outline : none;\n    color : white;\n    border : none;\n    padding : 5px;\n    font-size : 24px;\n  }\n"]);return Z=function(){return e},e}var ee=d.a.div(Z()),ne=d.a.div($()),te=function(e){var n=e.server,t=void 0===n?"wss://".concat(window.location.hostname):n,a=Object(r.useState)(),c=Object(y.a)(a,2),i=c[0],u=c[1],s=Object(r.useState)(),l=Object(y.a)(s,2),d=l[0],f=l[1],p=Object(r.useRef)();Object(r.useEffect)((function(){var e=new B({server:t});return e.on("open",Object(g.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),e.on("peer.connect",(function(e){console.log("Peer Connected: ".concat(e))})),e.on("browser.stream",(function(e,n){console.log("Stream Received",e),u(e),f(new V(n))})),function(){return e.destroy()}}),[t]);var h=function(){var e=Object(g.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onRequestBrowser"),e.next=3,V.createInstance();case 3:n=e.sent,console.log(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(ne,{ref:p},o.a.createElement(A,{source:i,vbController:d},o.a.createElement(H,{onRequestBrowser:h})),o.a.createElement(ee,null,o.a.createElement("button",{onClick:function(){var e=new Array("moz","ms","webkit");return!(!document.fullscreenEnabled||!e.some((function(e){return document["".concat(e,"FullscreenEnabled")]})))&&e.some((function(e){return"undefined"!==typeof document["".concat(e,"FullscreenElement")]&&(document["".concat(e,"FullscreenElement")]?document["".concat(e,"ExitFullscreen")]():p.current["".concat(e,"RequestFullscreen")](),!0)}))}},o.a.createElement(v,{icon:"expand"}))))};function re(){var e=Object(i.a)(["\n  width  : 100%;\n  height : 100%;\n  overflow-x : ",";\n  overflow-y : ",";\n  overflow : ",";\n"]);return re=function(){return e},e}var oe=d.a.div(re(),(function(e){var n=e.scrollX;return n?!0===n?"scroll":n:"hidden"}),(function(e){var n=e.scrollY;return n?!0===n?"scroll":n:"hidden"}),(function(e){var n=e.scroll;return n?!0===n?"scroll":n:"hidden"})),ae=t(9);function ce(){var e=Object(i.a)(["\n      html, body, #root {\n        width : 100%;\n        height : 100%;\n      }\n\n      /* http://meyerweb.com/eric/tools/css/reset/ \n        v2.0 | 20110126\n        License: none (public domain)\n      */\n\n      html, body, div, span, applet, object, iframe,\n      h1, h2, h3, h4, h5, h6, p, blockquote, pre,\n      a, abbr, acronym, address, big, cite, code,\n      del, dfn, em, img, ins, kbd, q, s, samp,\n      small, strike, strong, sub, sup, tt, var,\n      b, u, i, center,\n      dl, dt, dd, ol, ul, li,\n      fieldset, form, label, legend,\n      table, caption, tbody, tfoot, thead, tr, th, td,\n      article, aside, canvas, details, embed, \n      figure, figcaption, footer, header, hgroup, \n      menu, nav, output, ruby, section, summary,\n      time, mark, audio, video {\n        margin: 0;\n        padding: 0;\n        border: 0;\n        font-size: 100%;\n        font: inherit;\n        vertical-align: baseline;\n      }\n      /* HTML5 display-role reset for older browsers */\n      article, aside, details, figcaption, figure, \n      footer, header, hgroup, menu, nav, section {\n        display: block;\n      }\n      body {\n        line-height: 1;\n      }\n      ol, ul {\n        list-style: none;\n      }\n      blockquote, q {\n        quotes: none;\n      }\n      blockquote:before, blockquote:after,\n      q:before, q:after {\n        content: '';\n        content: none;\n      }\n      table {\n        border-collapse: collapse;\n        border-spacing: 0;\n      }\n    "]);return ce=function(){return e},e}function ie(){return o.a.createElement(ae.a,{styles:Object(ae.c)(ce())})}var ue={dark:{name:"dark",background:{primary:"#1B1C26",secondary:"#1B1C26"},darken:{x1:"rgba(0,0,0,0.2)"},text:{primary:"white",secondary:"white"}},light:{name:"light"}};function se(){var e=Object(i.a)(["\n  width : 100%;\n  height : 100%;\n  background : ",";\n  display : flex;\n  flex-direction : column;\n"]);return se=function(){return e},e}var le=d.a.div(se(),(function(e){return e.theme.darken.x1}));function de(){return o.a.createElement(le,null,o.a.createElement("div",null,"B"),o.a.createElement("div",null))}function fe(){var e=Object(i.a)(["\n  min-width : 65px;\n  box-sizing : content-box;\n  order : 0;\n  background : ",";\n"]);return fe=function(){return e},e}function pe(){var e=Object(i.a)(["\n  flex : 1;\n  // order : 0;\n"]);return pe=function(){return e},e}function he(){var e=Object(i.a)(["\n  width : 100vw;\n  height : 100vh;\n  display : flex;\n  flex-direction : row;\n  background : ",";\n"]);return he=function(){return e},e}var ve=d.a.div(he(),(function(e){return e.theme.background.primary})),be=d.a.div(pe()),me=d.a.div(fe(),(function(e){return e.theme.background.secondary}));var ge=function(){return o.a.createElement(u.a,{theme:ue.dark},o.a.createElement(oe,null,o.a.createElement(ie,null),o.a.createElement(s.a,null,o.a.createElement(ve,null,o.a.createElement(me,null,o.a.createElement(de,null)),o.a.createElement(be,null,o.a.createElement(l.a,{path:"/",exact:!0,component:te}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},67:function(e,n,t){e.exports=t(106)},72:function(e,n,t){},94:function(e,n){},96:function(e,n){}},[[67,1,2]]]);
//# sourceMappingURL=main.d1cec1ba.chunk.js.map